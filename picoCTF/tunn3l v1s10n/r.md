Итак, у меня есть изображение BMP со сломанным заголовком..

Смотрю в гугле и нахожу спецификацию БМП:

BMP-заголовок

Теперь я хочу просмотреть байты моего файла и изменить их, поэтому я загружаю свой файл в HexEd.it.

Tunnelvision.png

Итак, в моем файле есть волшебные байты 42 4D тогда размер 0x2c268e байт, а смещение массива пикселей равно 0xd0ba..

Затем идет заголовок DIB, и здесь он кажется отключенным, так как он также указывает размер заголовка 0xd0ba, хотя он должен составлять всего 40 байт! Итак, давайте изменим его и заменим BA D0 к 28 00, и сохраните изображение с расширением BMP..

И да! Похоже на изображение, которое я могу открыть! Однако я получаю странное изображение, поэтому, вероятно, мне также нужно изменить смещение того места, где можно найти массив пикселей, поэтому я меняю его на 54 байта, как в спецификации..

К сожалению, это пока не наш флаг... И здесь я отмечаю, что изображение, которое я получил до изменения смещения, немного отличалось (над флагом было больше изображений). notaflag часть). Это означает, что мое изображение должно быть больше.

Сейчас мое изображение имеет размер 1134*306 пикселей, и каждый пиксель занимает 3 байта (по одному на каждый цвет).).

Я пытался увеличить ширину изображения на 10 пикселей, но это испортило изображение.:

Однако то же самое не произошло, когда я увеличил высоту изображения. Мне просто нужно было найти высоту моего изображения. Напомним, что всего имеется 0x2c268e байт, заголовок 54 байта и ширина 1134 пикселя, по 3 байта на пиксель. Таким образом, мой рост:

(0x2c268e - 54) // (3*1134) = 850

Поэтому я ввожу 850 = 0x352 в заголовок..

Tunnelvision.png

И вот флаг:

Флаг: picoCTF{qu1t3_a_v13w_2020}
